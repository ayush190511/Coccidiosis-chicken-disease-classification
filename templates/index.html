<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chicken Disease Classification</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Poppins',sans-serif;
    background:linear-gradient(135deg,#eef2f7,#dbe4f3);
    min-height:100vh;
}

.app-title{
    font-weight:700;
    color:#1b2d6b;
}

.upload-box{
    border:2px dashed #1b2d6b;
    border-radius:16px;
    height:320px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    background:#fff;
    transition:.3s;
}

.upload-box:hover{
    background:#f7f9fc;
}

.upload-box img{
    max-height:280px;
    border-radius:12px;
}

.action-btns button{
    min-width:110px;
}

.result-card{
    border-radius:16px;
    min-height:320px;
}

.prediction-label{
    font-size:28px;
    font-weight:700;
    margin-top:20px;
    color:#28a745;
}

.prediction-badge{
    font-size:15px;
    padding:8px 16px;
}

#loading{
    position:fixed;
    inset:0;
    background:rgba(255,255,255,.75);
    z-index:9999;
    display:none;
}

.loader{
    width:60px;
    height:60px;
    border:6px solid #ddd;
    border-top:6px solid #1b2d6b;
    border-radius:50%;
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    animation:spin 1s linear infinite;
}

@keyframes spin{
    to{transform:translate(-50%,-50%) rotate(360deg)}
}

.footer-text{
    font-size:14px;
    color:#6c757d;
}
</style>
</head>

<body>

<div class="container py-4">
    <h2 class="text-center app-title mb-4">
        üêî Chicken Disease Classification
    </h2>

    <div class="row">

        <!-- LEFT -->
        <div class="col-md-6 mb-4 text-center">
            <div class="upload-box" id="uload">
                <span class="text-muted">
                    Click to upload image
                </span>
                <img id="photo" style="display:none"/>
            </div>

            <div class="action-btns mt-4">
                <button class="btn btn-primary mr-2" id="send" disabled>Predict</button>
                <button class="btn btn-outline-danger" id="reset">Reset</button>
            </div>

            <input type="file" id="fileinput" hidden>
            <input type="hidden" id="url" value="../predict">
        </div>

        <!-- RIGHT -->
        <div class="col-md-6 mb-4">
            <div class="card result-card shadow-sm">
                <div class="card-header bg-primary text-white text-center">
                    Prediction Result
                </div>

                <div class="card-body text-center">
                    <div class="res-part text-muted">
                        Upload an image and click <b>Predict</b>
                    </div>
                </div>

                <div class="card-footer text-center footer-text">
                    Model inference output
                </div>
            </div>
        </div>

    </div>
</div>

<div id="loading">
    <div class="loader"></div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script>
let base_data="";

$("#uload").click(()=>$("#fileinput").click());

$("#reset").click(()=>{
    base_data="";
    $("#photo").hide();
    $(".upload-box span").show();
    $(".res-part").html("Upload an image and click <b>Predict</b>");
    $("#send").prop("disabled",true);
});

$("#fileinput").change(function(){
    const reader=new FileReader();
    reader.onload=e=>{
        $("#photo").attr("src",e.target.result).show();
        $(".upload-box span").hide();
        base_data=e.target.result.split(",")[1];
        $("#send").prop("disabled",false);
    };
    reader.readAsDataURL(this.files[0]);
});

$("#send").click(()=>{
    $("#loading").show();

    $.ajax({
        url:$("#url").val(),
        type:"POST",
        contentType:"application/json",
        data:JSON.stringify({image:base_data}),
        success:function(res){
            $("#loading").hide();

            const predictionText = res[0].image;

            const html = `
                <span class="badge badge-success prediction-badge">
                    Prediction
                </span>
                <div class="prediction-label">
                    ${predictionText}
                </div>
            `;

            $(".res-part").html(html);
        },
        error:function(){
            $("#loading").hide();
            $(".res-part").html(
                "<span class='text-danger'>Server error. Try again.</span>"
            );
        }
    });
});
</script>

</body>
</html>
